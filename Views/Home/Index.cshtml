@{
  ViewData["Title"] = "蹊モンガ";
}

<style>
  .centered-container { display: flex; justify-content: center; align-items: center; height: calc(95vh - 120px); }
  .fade-in { opacity: 0; transition: opacity 1s ease-in-out; }
  .fade-in.visible { opacity: 1; }
  .section-container { margin: 100px 0; }
  .fade-in-img-wrapper { overflow: hidden; height: 100%; position: relative; }
  .fade-in-img { width: 100%; height: auto; transform: translateX(200%) scale(2); transition: transform 1.5s ease-in-out; }
  .fade-in-img-wrapper.visible .fade-in-img { transform: translateX(0) scale(1); }
  .fade-in-img-left { transform: translateX(-200%) scale(2); }
  .fade-in-img-wrapper.visible .fade-in-img-left { transform: translateX(0) scale(1); }
  .wave-text span { display: inline-block; opacity: 0; position: relative; }

  .circle-container { position: relative; width: 250px; height: 250px; margin: auto; }
  .circle { width: 250px; height: 250px; border: 2px solid transparent; border-radius: 50%; border-top-color: black; position: absolute; top: 0; left: 0; }
  .hidden-img { display: none; }
</style>

<div class="container centered-container text-center fade-in">
  <div class="content">
    <h1 class="wave-text" id="title">@ViewData["Title"]</h1>
    <div class="circle-container">
      <div class="circle" id="circle-animation"></div>
      <img src="https://www.pokemon.com/static-assets/content-assets/cms2/img/pokedex/full/587.png" class="img-fluid hidden-img" alt="エモンガ" width="250px" id="emolga-img">
    </div>

    <p class="mt-4 wave-text" id="description">
      "ポケモンの魅力を伝えたい"<br>
      成蹊大学ポケモンサークルの公式ホームページです。
    </p>
  </div>
</div>

<div class="container section-container fade-in">
  <div class="row align-items-center">
    <div class="col-md-6 text-center">
      <h2 class="wave-text" id="about">サークルについて</h2>
    </div>
    <div class="col-md-6 text-center fade-in-img-wrapper">
      <img src="https://horizons.pokemon.com/_images/home/gallery/hz-gallery-img-11-2x.jpg" class="img-fluid fade-in-img" alt="サークルについて">
    </div>
  </div>
</div>

<div class="container section-container fade-in">
  <div class="row align-items-center flex-row-reverse">
    <div class="col-md-6 text-center">
      <h2 class="wave-text" id="activity">活動記録</h2>
    </div>
    <div class="col-md-6 text-center fade-in-img-wrapper">
      <img src="https://horizons.pokemon.com/_images/home/gallery/hz-gallery-img-10-2x.jpg" class="img-fluid fade-in-img fade-in-img-left" alt="活動記録">
    </div>
  </div>
</div>

<div class="container section-container fade-in">
  <div class="row align-items-center">
    <div class="col-md-6 text-center">
      <h2 class="wave-text" id="contact">お問い合わせ</h2>
    </div>
    <div class="col-md-6 text-center fade-in-img-wrapper">
      <img src="https://horizons.pokemon.com/_images/home/gallery/hz-gallery-img-1-2x.jpg" class="img-fluid fade-in-img" alt="お問い合わせ">
    </div>
  </div>
</div>

@section Scripts {
  <script>
    $(document).ready(function() {
      function checkVisibility() {
        $('.fade-in').each(function() {
          var elementTop = $(this).offset().top;
          var elementBottom = elementTop + $(this).outerHeight();
          var viewportTop = $(window).scrollTop();
          var viewportBottom = viewportTop + $(window).height();

          if (elementBottom > viewportTop && elementTop < viewportBottom) {
            $(this).addClass('visible');
          } else {
            $(this).removeClass('visible');
          }
        });

        $('.fade-in-img-wrapper').each(function() {
          var elementTop = $(this).offset().top;
          var elementBottom = elementTop + $(this).outerHeight();
          var viewportTop = $(window).scrollTop();
          var viewportBottom = viewportTop + $(window).height();

          if (elementBottom > viewportTop && elementTop < viewportBottom) {
            $(this).addClass('visible');
          } else {
            $(this).removeClass('visible');
          }
        });

        $('.wave-text').each(function() {
          var elementTop = $(this).offset().top;
          var elementBottom = elementTop + $(this).outerHeight();
          var viewportTop = $(window).scrollTop();
          var viewportBottom = viewportTop + $(window).height();

          if (elementBottom > viewportTop && elementTop < viewportBottom) {
            if (!$(this).hasClass('animated')) {
              applyWaveEffect($(this));
              $(this).addClass('animated');
            }
          } else {
            $(this).removeClass('animated');
            resetWaveEffect($(this));
          }
        });
      }

      function applyWaveEffect(element) {
        var text = element.text();
        element.html('');
        for (var i = 0; i < text.length; i++) {
          element.append('<span>' + text.charAt(i) + '</span>');
        }

        element.find('span').each(function(index) {
          $(this).delay(index * 100).animate({
            opacity: 1,
            top: '-=10px'
          }, 300).animate({
            top: '+=12px'
          }, 300).animate({
            top: '-=2px'
          }, 300);
        });
      }

      function resetWaveEffect(element) {
        element.find('span').stop(true, true).css({ opacity: 0, top: '0px' });
        element.html(element.text());
      }

      function drawCircle() {
        var degrees = 0;
        var interval = setInterval(function() {
          $('#circle-animation').css('transform', 'rotate(' + degrees + 'deg)');
          degrees += 3.6;
          if (degrees >= 360) {
            clearInterval(interval);
            $('#emolga-img').fadeIn();
          }
        }, 10);
      }

      $(window).on('scroll resize', function() {
        checkVisibility();
      });

      checkVisibility();
      drawCircle();
    });
  </script>
}
